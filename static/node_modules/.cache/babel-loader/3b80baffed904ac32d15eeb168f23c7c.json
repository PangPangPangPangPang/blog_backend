{"ast":null,"code":"import _classCallCheck from \"/home/max/blog_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _possibleConstructorReturn from \"/home/max/blog_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/max/blog_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/max/blog_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/max/blog_frontend/src/container/login/login.js\";\n\n/**\n * Created by Max on 2019-03-25.\n */\nimport React from 'react';\nimport './login.css';\nimport PropTypes from 'prop-types';\nimport Modal from '../modal/modal';\nimport '../../compontent/reply';\nimport { getStore } from '../../App';\nimport request from '../../action/request';\nimport CloseImg from '../../img/closeImg';\nimport defaultIcon from '../../resource/png/default.png';\nimport { isPC } from '../../utils/utils';\n\nvar Login =\n/*#__PURE__*/\nfunction (_Modal) {\n  _inherits(Login, _Modal);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props));\n\n    _this.onClickSubmit = function () {\n      var _this$state = _this.state,\n          dispatch = _this$state.dispatch,\n          name = _this$state.name,\n          email = _this$state.email,\n          blog = _this$state.blog,\n          file = _this$state.file;\n      var _this$props = _this.props,\n          onLoginSuccess = _this$props.onLoginSuccess,\n          onLoginFailure = _this$props.onLoginFailure;\n      var form = new FormData();\n      form.append('name', name);\n      form.append('file', file);\n      form.append('email', email);\n      form.append('blog', blog);\n      dispatch(request('register', form, 'post')).then(function (res) {\n        var errormsg = res.errormsg,\n            errorcode = res.errorcode,\n            result = res.result;\n\n        if (errorcode === 0) {\n          var storage = window.localStorage;\n          storage.uuid = result.uuid;\n\n          if (onLoginSuccess) {\n            onLoginSuccess();\n          }\n        } else if (onLoginFailure) {\n          onLoginFailure(errormsg);\n        }\n      });\n    };\n\n    _this.onGetImage = function (e) {\n      var file = e.target.files[0];\n\n      if (file === undefined) {\n        return;\n      }\n\n      var type = file.type;\n\n      if (/^image\\/\\S+$/.test(type)) {\n        var src = URL.createObjectURL(file);\n\n        _this.setState({\n          icon: src,\n          file: file\n        });\n      }\n    };\n\n    _this.changeName = function (e) {\n      _this.setState({\n        name: e.target.value\n      });\n    };\n\n    _this.changeEmail = function (e) {\n      _this.setState({\n        email: e.target.value\n      });\n    };\n\n    _this.changeBlog = function (e) {\n      _this.setState({\n        blog: e.target.value\n      });\n    };\n\n    _this.subComponent = function () {\n      var onClickCancel = _this.props.onClickCancel;\n      var icon = _this.state.icon;\n      var chooseIcon = icon.length ? icon : defaultIcon;\n      return React.createElement(\"div\", {\n        className: \"login-container \".concat(isPC() ? 'login-container-pc' : 'login-container-phone'),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"login-close\",\n        type: \"button\",\n        onClick: onClickCancel,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, React.createElement(CloseImg, {\n        className: \"login-close-img\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 97\n        },\n        __self: this\n      })), React.createElement(\"label\", {\n        htmlFor: \"upload-photo\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: chooseIcon,\n        alt: \"\",\n        className: \"login-choose\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      })), React.createElement(\"input\", {\n        id: \"upload-photo\",\n        type: \"file\" // name=\"file\"\n        // id=\"input_file\"\n        ,\n        accept: \"image/jpeg,image/jpg,image/png\",\n        onChange: _this.onGetImage,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 102\n        },\n        __self: this\n      }), React.createElement(\"label\", {\n        className: \"login-label\",\n        htmlFor: \"register\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        className: \"login-input\",\n        placeholder: \"\\u6635\\u79F0(\\u5FC5\\u586B...)\",\n        value: _this.state.name,\n        type: \"text\",\n        name: \"name\",\n        onChange: _this.changeName,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 111\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        className: \"login-input\",\n        placeholder: \"\\u90AE\\u7BB1(\\u4E0D\\u6821\\u9A8C\\u54E6...)\",\n        value: _this.state.email,\n        type: \"text\",\n        name: \"name\",\n        onChange: _this.changeEmail,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }), React.createElement(\"input\", {\n        className: \"login-input\",\n        placeholder: \"\\u535A\\u5BA2\\uFF08py\\u5FC5\\u5907...\\uFF09\",\n        value: _this.state.blog,\n        type: \"text\",\n        name: \"name\",\n        onChange: _this.changeBlog,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127\n        },\n        __self: this\n      })), React.createElement(\"button\", {\n        className: \"reply-button\",\n        type: \"button\",\n        onClick: _this.onClickSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }, \"\\u63D0\\u4EA4\"));\n    };\n\n    var state = {\n      name: '',\n      email: '',\n      blog: '',\n      icon: '',\n      file: null,\n      dispatch: getStore().dispatch\n    };\n    _this.state = Object.assign({}, _this.state, state);\n    return _this;\n  }\n\n  return Login;\n}(Modal);\n\nLogin.PropTypes = {\n  onLoginSuccess: PropTypes.func,\n  onLoginFailure: PropTypes.func,\n  onClickCancel: PropTypes.func\n};\nLogin.defaultProps = {\n  onLoginSuccess: null,\n  onLoginFailure: null,\n  onClickCancel: null\n};\nexport default Login;","map":{"version":3,"sources":["/home/max/blog_frontend/src/container/login/login.js"],"names":["React","PropTypes","Modal","getStore","request","CloseImg","defaultIcon","isPC","Login","props","onClickSubmit","state","dispatch","name","email","blog","file","onLoginSuccess","onLoginFailure","form","FormData","append","then","res","errormsg","errorcode","result","storage","window","localStorage","uuid","onGetImage","e","target","files","undefined","type","test","src","URL","createObjectURL","setState","icon","changeName","value","changeEmail","changeBlog","subComponent","onClickCancel","chooseIcon","length","Object","assign","func","defaultProps"],"mappings":"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","sourcesContent":["/**\n * Created by Max on 2019-03-25.\n */\nimport React from 'react'\nimport './login.css'\nimport PropTypes from 'prop-types'\nimport Modal from '../modal/modal'\nimport '../../compontent/reply'\nimport { getStore } from '../../App'\nimport request from '../../action/request'\nimport CloseImg from '../../img/closeImg'\nimport defaultIcon from '../../resource/png/default.png'\nimport { isPC } from '../../utils/utils'\n\nclass Login extends Modal {\n  constructor(props) {\n    super(props)\n    const state = {\n      name: '',\n      email: '',\n      blog: '',\n      icon: '',\n      file: null,\n      dispatch: getStore().dispatch,\n    }\n    this.state = Object.assign({}, this.state, state)\n  }\n\n  onClickSubmit = () => {\n    const {\n      dispatch, name, email, blog, file,\n    } = this.state\n    const { onLoginSuccess, onLoginFailure } = this.props\n    const form = new FormData()\n    form.append('name', name)\n    form.append('file', file)\n    form.append('email', email)\n    form.append('blog', blog)\n    dispatch(request('register', form, 'post')).then((res) => {\n      const { errormsg, errorcode, result } = res\n      if (errorcode === 0) {\n        const storage = window.localStorage\n        storage.uuid = result.uuid\n        if (onLoginSuccess) {\n          onLoginSuccess()\n        }\n      } else if (onLoginFailure) {\n        onLoginFailure(errormsg)\n      }\n    })\n  };\n\n  onGetImage = (e) => {\n    const file = e.target.files[0]\n    if (file === undefined) {\n      return\n    }\n    const { type } = file\n    if (/^image\\/\\S+$/.test(type)) {\n      const src = URL.createObjectURL(file)\n      this.setState({\n        icon: src,\n        file,\n      })\n    }\n  };\n\n  changeName = (e) => {\n    this.setState({\n      name: e.target.value,\n    })\n  };\n\n  changeEmail = (e) => {\n    this.setState({\n      email: e.target.value,\n    })\n  };\n\n  changeBlog = (e) => {\n    this.setState({\n      blog: e.target.value,\n    })\n  };\n\n  subComponent = () => {\n    const { onClickCancel } = this.props\n    const { icon } = this.state\n    const chooseIcon = icon.length ? icon : defaultIcon\n    return (\n      <div\n        className={`login-container ${\n          isPC() ? 'login-container-pc' : 'login-container-phone'\n        }`}\n      >\n        <button className=\"login-close\" type=\"button\" onClick={onClickCancel}>\n          <CloseImg className=\"login-close-img\" />\n        </button>\n        <label htmlFor=\"upload-photo\">\n          <img src={chooseIcon} alt=\"\" className=\"login-choose\" />\n        </label>\n        <input\n          id=\"upload-photo\"\n          type=\"file\"\n          // name=\"file\"\n          // id=\"input_file\"\n          accept=\"image/jpeg,image/jpg,image/png\"\n          onChange={this.onGetImage}\n        />\n        <label className=\"login-label\" htmlFor=\"register\">\n          <input\n            className=\"login-input\"\n            placeholder=\"昵称(必填...)\"\n            value={this.state.name}\n            type=\"text\"\n            name=\"name\"\n            onChange={this.changeName}\n          />\n          <input\n            className=\"login-input\"\n            placeholder=\"邮箱(不校验哦...)\"\n            value={this.state.email}\n            type=\"text\"\n            name=\"name\"\n            onChange={this.changeEmail}\n          />\n          <input\n            className=\"login-input\"\n            placeholder=\"博客（py必备...）\"\n            value={this.state.blog}\n            type=\"text\"\n            name=\"name\"\n            onChange={this.changeBlog}\n          />\n        </label>\n        <button\n          className=\"reply-button\"\n          type=\"button\"\n          onClick={this.onClickSubmit}\n        >\n          提交\n        </button>\n      </div>\n    )\n  };\n}\n\nLogin.PropTypes = {\n  onLoginSuccess: PropTypes.func,\n  onLoginFailure: PropTypes.func,\n  onClickCancel: PropTypes.func,\n}\n\nLogin.defaultProps = {\n  onLoginSuccess: null,\n  onLoginFailure: null,\n  onClickCancel: null,\n}\n\nexport default Login\n"]},"metadata":{},"sourceType":"module"}